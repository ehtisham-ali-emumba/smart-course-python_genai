# Snippet for JWT-protected routes â€” include from location blocks.
# Use: include /etc/nginx/conf.d/protected-snippet.conf;
auth_request /internal/auth-verify;
auth_request_set $auth_user_id   $upstream_http_x_auth_user_id;
auth_request_set $auth_user_role $upstream_http_x_auth_user_role;
proxy_set_header X-User-ID $auth_user_id;
proxy_set_header X-User-Role $auth_user_role;
