# ─── Rate limit zones ─────────────────────────────────────────────
# $binary_remote_addr uses ~64 bytes per entry (vs ~128 for $remote_addr)

# General API rate limit: 30 requests/second per IP
limit_req_zone $binary_remote_addr zone=api_general:10m rate=30r/s;

# Auth endpoints: stricter to prevent brute force
# 5 requests/second per IP for login/register
limit_req_zone $binary_remote_addr zone=api_auth:10m rate=5r/s;

# Token refresh: 2 requests/second
limit_req_zone $binary_remote_addr zone=api_refresh:5m rate=2r/s;

# Default rate limit response code and log level
limit_req_status 429;
limit_req_log_level warn;
